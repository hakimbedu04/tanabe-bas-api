@using System.Globalization
@{
    Layout = null;
}

<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0" />
    <title>Expense Slip</title>
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" media="screen, print" />
    <style type="text/css" media="screen, print">
        #mainProp {
            margin: 0 auto;
            padding: 0;
            width: 800px;
            border: 1px solid #E0E0E0;
            background-color: #edeef0;
            font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
            font-size: 12px;
            -webkit-print-color-adjust: exact;
            position: relative;
        }

            #mainProp h1 {
                margin: 0px 0;
                padding: 4px 0 4px 8px;
                font-size: 105%;
                color: #FFF;
                text-transform: none;
                background-color: #E0E0E0;
                letter-spacing: .5px;
                -webkit-print-color-adjust: exact;
            }


        #mainFooter {
            margin: 0 auto;
            padding: 5px;
            width: 690px;
            border: 1px solid #EBEBEB;
            background-color: #edeef0;
            -webkit-box-shadow: 8px 8px 8px -6px black;
            -moz-box-shadow: 8px 8px 8px -6px black;
            box-shadow: 8px 8px 8px -6px black;
            -webkit-print-color-adjust: exact;
        }


        #main h1 {
            margin: 0px 0;
            padding: 4px 0 4px 8px;
            font-size: 105%;
            color: #FFF;
            text-transform: none;
            background-color: #CC0000;
            letter-spacing: .5px;
            text-align: center;
            -webkit-print-color-adjust: exact;
        }


        .style1 {
            height: 44px;
        }

        .style2 {
            width: 100%;
        }

        .style3 {
            width: 16px;
            height: 16px;
        }

        .style4 {
            height: 16px;
        }

        .style5 {
            height: 28px;
        }

        .style6 {
            width: 350px;
        }

        .style9 {
            font-size: x-small;
        }

        .style10 {
            width: 80%;
            border-collapse: collapse;
            border: 1px solid #000000;
        }

        .style12 {
            font-size: xx-small;
        }

        .auto-style1 {
            height: 85px;
        }

        .img {
            padding: 1px;
            border: 1px solid #021a40;
            width: 12px;
            height: 12px;
            -webkit-print-color-adjust: exact;
            /*background-color:#ff0;*/
        }

        .adInfoBox1 {
            padding: 5px 5px 5px 10px;
            position: absolute;
            bottom: 0px;
            width: 457px;
            font-style: italic;
            font-size: xx-small;
        }
    </style>
</head>
<body>
    <div id="mainProp" style="background-color:White; margin-top:5px; height:1224px;">
        <table border="0" cellpadding="0" cellspacing="1"
               style="table-layout:auto; width:800px; font-size:xx-small" align="center">
            <tr>
                <td style="width:230px; padding:5px;border-bottom-style:solid;border-bottom:solid;font-size:x-small" align="left" valign="middle">
                    <table border="0" cellpadding="0" cellspacing="0" class="style2">
                        <tr>
                            <td>
                                <img src="~/Content/Images/logo_default.jpg" height="32" />
                            </td>
                        </tr>
                    </table>
                </td>
                <td style="width:5px;border-bottom-style:solid;border-bottom:solid;" align="center">
                    &nbsp;
                </td>
                <td style="width:490px;border-bottom-style:solid;border-bottom:solid;font-size:medium" align="center" colspan="4">
                    <strong>Expense Slip</strong>
                </td>
            </tr>
            <tr style="background-color:lightgrey;height:auto;font-weight:bold;border-bottom:1px solid #021a40;">
                <td style="padding-left:2px;padding-top:1px;padding-bottom:1px;height:auto;"></td>
                <td style="width:5px"></td>
                <td style="width:210px"></td>
                <td style="width:45px">
                    EXP NO
                </td>
                <td style="width:5px">
                    :
                </td>
                <td style="width:220px">
                    @TempData["spr_no"]
                </td>
            </tr>
            <tr style="background-color:lightgrey;height:auto;font-weight:bold;border-bottom:1px solid #021a40;">
                <td style="padding-left:2px;padding-top:1px;padding-bottom:1px" colspan="3">
                    1. APPLICANT
                </td>
                <td>
                    Date Created
                </td>
                <td>
                    :
                </td>
                <td>
                    @TempData["spr_date"]
                </td>
            </tr>
            <tr>
                <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                    Initiator Position
                </td>
                <td>
                    :
                </td>
                <td colspan="4">
                    @TempData["initiator_position"]
                </td>
            </tr>
            <tr>
                <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                    Name of Initiator
                </td>
                <td>
                    :
                </td>
                <td colspan="4">
                    @TempData["initiator_name"]
                </td>
            </tr>
            <tr>
                <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                    Name of AM
                </td>
                <td>
                    :
                </td>
                <td colspan="4">
                    @TempData["initiator_am"]
                </td>
            </tr>
            <tr>
                <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                    Branch
                </td>
                <td>
                    :
                </td>
                <td colspan="4">
                    @TempData["initiator_branch"]
                </td>
            </tr>
            <tr>
                <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                    Region
                </td>
                <td>
                    :
                </td>
                <td colspan="4">
                    @TempData["initiator_region"]
                </td>
            </tr>
            <tr>
                <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                    Initiator Contact
                </td>
                <td>
                    :
                </td>
                <td colspan="4">
                    <asp:label id="lbInitiatorContact" font-bold="True"></asp:label>
                </td>
            </tr>
            <tr style="background-color:lightgrey;height:auto;font-weight:bold;border-bottom:1px solid #021a40;border-top:1px solid #021a40;">
                <td style="padding-left:2px;padding-top:1px;padding-bottom:1px" colspan="6">
                    2. HEADER INFORMATION
                </td>
            </tr>
            <tr>
                <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                    Header Description
                </td>
                <td>
                    :
                </td>
                <td width="185">
                    @TempData["event_name"]
                </td>
                <td style="padding-left:15px;padding-top:1px;padding-bottom:1px;width:150px">
                    Date Event
                </td>
                <td style="width:5px">
                    :
                </td>
                <td>
                    @TempData["event_date_start"]
                </td>
            </tr>
            @*<tr>
                    <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                        Daybook
                    </td>
                    <td style="width:5px">
                        :
                    </td>
                    <td>
                        @TempData["event_topic")
                    </td>
                    <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">

                    </td>
                    <td style="width:5px">

                    </td>
                    <td>

                    </td>
                </tr>
                <tr>
                    <td style="padding-left:15px;padding-top:1px;padding-bottom:1px">
                        Allocation
                    </td>
                    <td>
                        :
                    </td>
                    <td colspan="4">
                        @TempData["event_place")
                    </td>
                </tr>*@

            <tr style="background-color:lightgrey;height:auto;font-weight:bold;border-bottom:1px solid #021a40;border-top:1px solid #021a40;">
                <td style="padding-left:2px;padding-top:1px;padding-bottom:1px" colspan="6">
                    3. DETAIL EXPENSE
                </td>
            </tr>
            <tr>
                <td style="padding-left:0px;padding-top:1px;padding-bottom:1px" colspan="6">
                    <table style="color: #F0F0F0; border: solid #2c4182 1px; background: #566BAD; width: 100%;">
                        <thead>
                            <tr>
                                <td style="font-size:8pt;text-align:Center;padding:2px; border-left: solid #2c4182 1px;">No</td>
                                <td style="font-size:8pt;text-align:Center;padding:2px; border-left: solid #2c4182 1px;">Detail Description</td>
                                <td style="font-size:8pt;text-align:Center;padding:2px; border-left: solid #2c4182 1px;">Amount</td>
                            </tr>
                        </thead>
                        <tbody style="background: #fff; color: #000; text-align: left;">
                            @if (((List<SF_Domain.DTOs.BAS.Temp_HCP_DTO>)TempData["tempHcpDTODetail"]).Count > 0)
                            {
                                Nullable<double> total_hcp = 0;
                                int index = 1;
                                foreach (SF_Domain.DTOs.BAS.Temp_HCP_DTO item in (List<SF_Domain.DTOs.BAS.Temp_HCP_DTO>)TempData["tempHcpDTODetail"])
                                {
                                    <tr>
                                        <td style="font-size:8pt;padding:2px; border-left: solid #fff 1px;">@index</td>
                                        <td style="font-size:8pt;padding:2px; border-left: solid #fff 1px;">@item.Sponsor</td>
                                        <td style="font-size:8pt;padding:2px; border-left: solid #fff 1px; width: 100px">@String.Format(CultureInfo.CreateSpecificCulture("eu-EU"), "{0:n2}", Convert.ToDecimal(@item.Amount))</td>
                                    </tr>
                                    total_hcp += item.Amount;
                                    index++;
                                }
                                <tr style="background: #6D82C5;">
                                    <td class="dxgv" colspan="3">
                                        <div style="color: #848484; text-align: right; color: #F0F0F0; font-size:8pt">
                                            Total : @String.Format(CultureInfo.CreateSpecificCulture("eu-EU"), "{0:n2}", Convert.ToDecimal(total_hcp))
                                        </div>
                                    </td>
                                </tr>
                            }
                            else
                            {
                                <tr style="background: #F0F0F0; height: 70px;">
                                    <td class="dxgv" colspan="2">
                                        <div style="color: #848484; text-align: center;">
                                            No data to display
                                        </div>
                                    </td>
                                </tr>
                                <tr style="background: #6D82C5;">
                                    <td class="dxgv" colspan="2">
                                        <div style="color: #848484; text-align: right; color: #F0F0F0; font-size:8pt">
                                            Total : 0
                                        </div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </td>
                </td>
            </tr>

            <tr style="background-color:lightgrey;height:auto;font-weight:bold;border-bottom:1px solid #021a40;border-top:1px solid #021a40;">
                <td style="padding-left:2px;padding-top:1px;padding-bottom:1px" colspan="6">
                    4. APPROVAL
                </td>
            </tr>
            <tr>
                <td style="padding-left:0px;padding-top:1px;padding-bottom:1px" colspan="6">
                    <table style="color: #F0F0F0; border: solid #2c4182 1px; background: #566BAD; width: 100%;">
                        <thead>
                            <tr>
                                <td style="font-size:8pt;text-align:Center;padding:2px; border-left: solid #2c4182 1px;">Position</td>
                                <td style="font-size:8pt;text-align:Center;padding:2px; border-left: solid #2c4182 1px;">Functionary</td>
                                <td style="font-size:8pt;text-align:Center;padding:2px; border-left: solid #2c4182 1px;">Approval</td>
                                <td style="font-size:8pt;text-align:Center;padding:2px; border-left: solid #2c4182 1px;">Comment</td>
                                <td style="font-size:8pt;text-align:Center;padding:2px; border-left: solid #2c4182 1px;">Date Approved</td>
                            </tr>
                        </thead>
                        <tbody style="background: #fff; color: #000; text-align: left;">
                            @if (((List<SF_Domain.DTOs.BAS.Temp_Approval_DTO>)TempData["tempApprovalDTO"]).Count > 0)
                            {
                                foreach (SF_Domain.DTOs.BAS.Temp_Approval_DTO item in (List<SF_Domain.DTOs.BAS.Temp_Approval_DTO>)TempData["tempApprovalDTO"])
                                {
                                    <tr>
                                        <td style="font-size:8pt;padding:2px; border-left: solid #fff 1px;">@item.position</td>
                                        <td style="font-size:8pt;padding:2px; border-left: solid #fff 1px;">@item.functional</td>
                                        <td style="font-size:8pt;padding:2px; border-left: solid #fff 1px;">@item.approval</td>
                                        <td style="font-size:8pt;padding:2px; border-left: solid #fff 1px; width: 400px">@item.comment</td>
                                        <td style="font-size:6pt;padding:2px; border-left: solid #fff 1px; ">@String.Format("{0:dd/MM/yyyy hh.mm.sss}", @item.date_approved)</td>
                                    </tr>
                                }
                                <tr style="background: #6D82C5;">
                                    <td class="dxgv" colspan="5">
                                        <div style="color: #848484; text-align: right; color: #F0F0F0; font-size:8pt"></div>
                                    </td>
                                </tr>
                            }
                            else
                            {
                                <tr style="background: #F0F0F0; height: 70px;">
                                    <td class="dxgv" colspan="5">
                                        <div style="color: #848484; text-align: center;">
                                            No data to display
                                        </div>
                                    </td>
                                </tr>
                                <tr style="background: #6D82C5;">
                                    <td class="dxgv" colspan="5">
                                        <div style="color: #848484; text-align: right; color: #F0F0F0; font-size:8pt"></div>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </td>
            </tr>

            <tr>
                <td colspan="6">
                    <table cellpadding="0" cellspacing="0" class="style2">
                        <tr>
                            <td style="width:60%;font-size:x-small">
                                Initiator / Submitted by :<br />
                                Signed and Name<br />
                                <br />
                                <br />
                                <br />
                                @TempData["initiator_name"]
                                <br />
                                <hr align="left" width="50%" />
                                Date :
                                @TempData["spr_date"]
                            </td>
                            <td style="width:50%;font-size:x-small">
                                @*Known / Approved by :<br />
                                    Signed and Name<br />
                                    <br />
                                    <br />
                                    <br />
                                    <asp:label id="lbSignNameApp" font-bold="True"></asp:label>
                                    <br />
                                    <hr align="left" width="70%" />Date :
                                    <asp:label id="lbSignDateApp" font-bold="True"></asp:label>*@
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
        <div class="adInfoBox1">
            Print out by system, Valid without signature
        </div>
    </div>

</body>
</html>